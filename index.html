<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NovaCrypto</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Optional: this name shows when you add it to Home Screen -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="NovaCrypto">

  <style>
    :root {
      --bg: #060712;
      --bg-alt: #0b0d18;
      --card: #101321;
      --accent: #3b82f6;
      --accent-soft: rgba(59,130,246,0.15);
      --accent-2: #22c55e;
      --accent-2-soft: rgba(34,197,94,0.15);
      --danger: #ef4444;
      --text-main: #f9fafb;
      --text-muted: #9ca3af;
      --border-subtle: #1f2933;
      --shadow-soft: 0 18px 45px rgba(0,0,0,0.65);
      --radius-xl: 22px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
    }

    body {
      background: radial-gradient(circle at top, #111827 0, #020617 55%);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      align-items: stretch;
      justify-content: center;
    }

    /* Loading Screen */
    #loading-screen {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, #020617 0, #000 65%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 24px;
      z-index: 50;
    }

    .loading-logo-wrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    .loading-logo-icon {
      width: 80px;
      height: 80px;
      border-radius: 26px;
      background: conic-gradient(from 210deg, #22c55e, #3b82f6, #6366f1, #22c55e);
      padding: 3px;
      box-shadow: 0 0 35px rgba(59,130,246,0.65);
      animation: spinGlow 3.5s linear infinite;
    }

    .loading-logo-inner {
      width: 100%;
      height: 100%;
      border-radius: 23px;
      background: radial-gradient(circle at 30% 0%, #0b1120, #020617);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 26px;
      letter-spacing: 0.08em;
      color: #e5f2ff;
      text-shadow: 0 0 12px rgba(59,130,246,0.9);
    }

    .loading-title {
      font-size: 22px;
      font-weight: 700;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: #e5e7eb;
    }

    .loading-subtitle {
      font-size: 13px;
      color: var(--text-muted);
    }

    .loading-bar-outer {
      width: 70%;
      max-width: 320px;
      height: 7px;
      border-radius: 999px;
      background: rgba(15,23,42,0.8);
      overflow: hidden;
      border: 1px solid rgba(148,163,184,0.25);
      box-shadow: 0 0 0 1px rgba(15,23,42,0.9);
    }

    .loading-bar-inner {
      height: 100%;
      width: 0%;
      border-radius: 999px;
      background: linear-gradient(90deg, #22c55e, #3b82f6);
      box-shadow: 0 0 12px rgba(59,130,246,0.9);
      transition: width 0.15s ease-out;
    }

    .loading-meta {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 8px;
    }

    @keyframes spinGlow {
      0% { transform: rotate(0deg); box-shadow: 0 0 28px rgba(59,130,246,0.9); }
      50% { box-shadow: 0 0 40px rgba(34,197,94,0.95); }
      100% { transform: rotate(360deg); box-shadow: 0 0 28px rgba(59,130,246,0.9); }
    }

    /* App Shell */
    .hidden {
      display: none !important;
    }

    #app {
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
      padding: 14px 12px 70px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    header.app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 6px 4px 10px;
    }

    .app-brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-logo {
      width: 32px;
      height: 32px;
      border-radius: 14px;
      background: conic-gradient(from 200deg, #22c55e, #3b82f6, #6366f1, #22c55e);
      padding: 2px;
    }

    .brand-logo-inner {
      width: 100%;
      height: 100%;
      border-radius: 12px;
      background: radial-gradient(circle at 30% 0%, #0b1120, #020617);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 800;
      letter-spacing: 0.12em;
      color: #e5f2ff;
    }

    .brand-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .brand-name {
      font-size: 15px;
      font-weight: 600;
      letter-spacing: 0.09em;
      text-transform: uppercase;
    }

    .brand-tagline {
      font-size: 11px;
      color: var(--text-muted);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .status-pill {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(22,163,74,0.18);
      color: #bbf7d0;
      border: 1px solid rgba(22,163,74,0.45);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .status-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 9px rgba(34,197,94,0.9);
    }

    .avatar {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 0%, #1d4ed8, #020617);
      border: 1px solid rgba(148,163,184,0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
      color: #e5e7eb;
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .balance-card {
      background: radial-gradient(circle at top left, rgba(59,130,246,0.32), #020617 65%);
      border-radius: 26px;
      padding: 18px 18px 16px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(55,65,81,0.7);
      position: relative;
      overflow: hidden;
    }

    .balance-card::before {
      content: "";
      position: absolute;
      inset: -60%;
      background-image: radial-gradient(circle at 10% 0%, rgba(59,130,246,0.21) 0, transparent 55%),
                        radial-gradient(circle at 90% 100%, rgba(34,197,94,0.18) 0, transparent 50%);
      opacity: 0.88;
      pointer-events: none;
    }

    .balance-inner {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .balance-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .balance-label {
      font-size: 13px;
      color: #cbd5f5;
      text-transform: uppercase;
      letter-spacing: 0.16em;
    }

    .balance-chip {
      font-size: 11px;
      padding: 3px 10px;
      border-radius: 999px;
      background: rgba(15,23,42,0.6);
      color: #c7d2fe;
      border: 1px solid rgba(129,140,248,0.5);
    }

    .balance-amount {
      font-size: 30px;
      font-weight: 700;
      letter-spacing: 0.03em;
    }

    .balance-meta-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .balance-change {
      font-size: 13px;
      color: #bbf7d0;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .balance-change.neg {
      color: #fecaca;
    }

    .change-pill {
      font-size: 11px;
      padding: 2px 7px;
      border-radius: 999px;
      background: rgba(22,163,74,0.22);
      color: #bbf7d0;
      border: 1px solid rgba(22,163,74,0.7);
    }

    .network-label {
      font-size: 11px;
      color: #cbd5f5;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .network-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      border: 1px solid rgba(34,197,94,0.8);
      position: relative;
    }

    .network-dot::after {
      content: "";
      position: absolute;
      inset: 2px;
      border-radius: inherit;
      background: #22c55e;
      box-shadow: 0 0 10px rgba(34,197,94,0.8);
    }

    .controls-row {
      display: flex;
      gap: 10px;
      margin-top: 6px;
    }

    .btn {
      flex: 1;
      border-radius: 999px;
      border: none;
      font-size: 13px;
      font-weight: 500;
      padding: 9px 0;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: transform 0.08s ease-out, box-shadow 0.08s ease-out, background 0.12s ease-out;
      -webkit-tap-highlight-color: transparent;
    }

    .btn-primary {
      background: linear-gradient(135deg, #2563eb, #38bdf8);
      color: #eef2ff;
      box-shadow: 0 10px 30px rgba(59,130,246,0.6);
    }

    .btn-secondary {
      background: rgba(15,23,42,0.9);
      color: #e5e7eb;
      border: 1px solid rgba(148,163,184,0.6);
      box-shadow: 0 10px 30px rgba(15,23,42,0.8);
    }

    .btn:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: none;
    }

    .btn-icon {
      font-size: 14px;
    }

    /* Stats strip */
    .stats-row {
      display: flex;
      gap: 10px;
      margin-top: 8px;
    }

    .stat-card {
      flex: 1;
      background: rgba(15,23,42,0.9);
      border-radius: 16px;
      padding: 10px 10px 9px;
      border: 1px solid var(--border-subtle);
    }

    .stat-label {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .stat-value {
      font-size: 14px;
      font-weight: 600;
    }

    .stat-tag {
      font-size: 10px;
      margin-top: 2px;
      color: #a5b4fc;
    }

    /* Activity */
    .section-card {
      background: var(--bg-alt);
      border-radius: var(--radius-xl);
      padding: 12px 12px 10px;
      border: 1px solid var(--border-subtle);
      box-shadow: 0 10px 28px rgba(0,0,0,0.7);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .section-title {
      font-size: 14px;
      font-weight: 600;
    }

    .section-subtitle {
      font-size: 11px;
      color: var(--text-muted);
    }

    .fake-filter-pill {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(75,85,99,0.8);
      color: #d1d5db;
      background: rgba(15,23,42,0.9);
    }

    .activity-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 180px;
      overflow: hidden;
    }

    .activity-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      padding: 7px 4px;
    }

    .activity-main {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .activity-title {
      font-size: 13px;
      font-weight: 500;
    }

    .activity-subtitle {
      font-size: 11px;
      color: var(--text-muted);
    }

    .activity-amount {
      font-size: 13px;
      font-weight: 500;
      white-space: nowrap;
    }

    .activity-amount.pos {
      color: #bbf7d0;
    }
    .activity-amount.neg {
      color: #fecaca;
    }

    /* Bottom nav */
    .bottom-nav {
      position: fixed;
      left: 50%;
      bottom: 12px;
      transform: translateX(-50%);
      width: 100%;
      max-width: 420px;
      padding: 4px 12px;
      z-index: 10;
    }

    .bottom-nav-inner {
      background: rgba(15,23,42,0.96);
      border-radius: 999px;
      border: 1px solid rgba(31,41,55,0.9);
      padding: 4px;
      display: flex;
      justify-content: space-between;
      gap: 4px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.9);
      backdrop-filter: blur(16px);
    }

    .nav-item {
      flex: 1;
      border-radius: 999px;
      border: none;
      padding: 6px 0;
      font-size: 11px;
      color: #9ca3af;
      background: transparent;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }

    .nav-icon {
      font-size: 16px;
    }

    .nav-item.active {
      background: radial-gradient(circle at top, rgba(59,130,246,0.35), rgba(15,23,42,0.98));
      color: #e5e7eb;
      box-shadow: 0 0 0 1px rgba(37,99,235,0.6);
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.75);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 40;
    }

    .modal {
      width: 100%;
      max-width: 360px;
      background: #020617;
      border-radius: 22px;
      padding: 18px 16px 14px;
      border: 1px solid rgba(55,65,81,0.9);
      box-shadow: 0 18px 40px rgba(0,0,0,0.95);
    }

    .modal-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .modal-caption {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 14px;
    }

    .modal-input-group {
      display: flex;
      align-items: center;
      background: #020617;
      border-radius: 14px;
      border: 1px solid rgba(75,85,99,0.9);
      padding: 8px 10px;
      gap: 6px;
      margin-bottom: 14px;
    }

    .modal-input-group span {
      font-size: 13px;
      color: #9ca3af;
    }

    .modal-input-group input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      font-size: 14px;
      color: #e5e7eb;
      padding: 2px 0;
    }

    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
    }

    .btn-ghost {
      font-size: 13px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(75,85,99,0.9);
      background: transparent;
      color: #d1d5db;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }

    .btn-ghost-danger {
      border-color: rgba(248,113,113,0.8);
      color: #fecaca;
    }

    .btn-solid {
      font-size: 13px;
      padding: 6px 12px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #2563eb, #38bdf8);
      color: #f9fafb;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 75px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(15,23,42,0.98);
      color: #e5e7eb;
      font-size: 12px;
      padding: 7px 12px;
      border-radius: 999px;
      border: 1px solid rgba(55,65,81,0.9);
      box-shadow: 0 14px 35px rgba(0,0,0,0.9);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.18s ease-out, transform 0.18s ease-out;
      z-index: 35;
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(-4px);
    }

    /* Small screens tweak */
    @media (max-width: 380px) {
      .balance-amount {
        font-size: 26px;
      }
    }
  </style>
</head>
<body>

  <!-- LOADING SCREEN -->
  <div id="loading-screen">
    <div class="loading-logo-wrap">
      <div class="loading-logo-icon">
        <div class="loading-logo-inner">NC</div>
      </div>
      <div class="loading-title">NovaCrypto</div>
      <div class="loading-subtitle">Secure Digital Yield Engine</div>
    </div>

    <div class="loading-bar-outer">
      <div class="loading-bar-inner" id="loading-bar"></div>
    </div>
    <div class="loading-meta">Syncing with NovaCore&trade; mainnet...</div>
  </div>

  <!-- APP -->
  <div id="app" class="hidden">
    <header class="app-header">
      <div class="app-brand">
        <div class="brand-logo">
          <div class="brand-logo-inner">NV</div>
        </div>
        <div class="brand-text">
          <div class="brand-name">NovaCrypto</div>
          <div class="brand-tagline">Multi-asset yield wallet</div>
        </div>
      </div>
      <div class="header-right">
        <div class="status-pill">
          <span class="status-dot"></span>
          <span>Live</span>
        </div>
        <div class="avatar">DT</div>
      </div>
    </header>

    <main>
      <!-- Balance card -->
      <section class="balance-card">
        <div class="balance-inner">
          <div class="balance-header">
            <div class="balance-label">Total Balance</div>
            <div class="balance-chip">Nova Tier ‚Ä¢ Prime</div>
          </div>
          <div class="balance-amount" id="balance-amount">$40,000.00</div>

          <div class="balance-meta-row">
            <div class="balance-change" id="balance-change">
              <span>‚ñ≤</span>
              <span>+$0.00 today</span>
              <span class="change-pill" id="change-pill">+0.00%</span>
            </div>
            <div class="network-label">
              <span class="network-dot"></span>
              <span>Auto-yield enabled</span>
            </div>
          </div>

          <div class="controls-row">
            <button class="btn btn-primary" id="add-funds-btn">
              <span class="btn-icon">Ôºã</span>
              <span>Add Funds</span>
            </button>
            <button class="btn btn-secondary" id="withdraw-funds-btn">
              <span class="btn-icon">‚áÑ</span>
              <span>Withdraw</span>
            </button>
          </div>

          <div class="stats-row">
            <div class="stat-card">
              <div class="stat-label">24h Yield</div>
              <div class="stat-value" id="stat-24h-yield">+$0.00</div>
              <div class="stat-tag">NovaEarn ‚Ä¢ Auto</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Allocation</div>
              <div class="stat-value">70% Crypto</div>
              <div class="stat-tag">30% Equity</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Activity -->
      <section class="section-card">
        <div class="section-header">
          <div>
            <div class="section-title">Recent Activity</div>
            <div class="section-subtitle">Last 5 operations</div>
          </div>
          <button class="fake-filter-pill" type="button">Filters ‚ñæ</button>
        </div>

        <ul class="activity-list" id="activity-list">
          <li class="activity-item">
            <div class="activity-main">
              <div class="activity-title">Auto-yield cycle</div>
              <div class="activity-subtitle">NovaCore scheduled reward</div>
            </div>
            <div class="activity-amount pos">+$15.00</div>
          </li>
          <li class="activity-item">
            <div class="activity-main">
              <div class="activity-title">Portfolio rebalance</div>
              <div class="activity-subtitle">BTC / ETH / Index basket</div>
            </div>
            <div class="activity-amount">‚Ä¢‚Ä¢‚Ä¢</div>
          </li>
          <li class="activity-item">
            <div class="activity-main">
              <div class="activity-title">Security check</div>
              <div class="activity-subtitle">Device verified ‚Ä¢ iOS</div>
            </div>
            <div class="activity-amount">OK</div>
          </li>
        </ul>
      </section>
    </main>

    <!-- Bottom Nav -->
    <nav class="bottom-nav">
      <div class="bottom-nav-inner">
        <button class="nav-item active" data-tab="home">
          <span class="nav-icon">üè†</span>
          <span>Home</span>
        </button>
        <button class="nav-item" data-tab="portfolio">
          <span class="nav-icon">üìä</span>
          <span>Portfolio</span>
        </button>
        <button class="nav-item" data-tab="markets">
          <span class="nav-icon">üìà</span>
          <span>Markets</span>
        </button>
        <button class="nav-item" data-tab="settings">
          <span class="nav-icon">‚öôÔ∏è</span>
          <span>Settings</span>
        </button>
      </div>
    </nav>

    <!-- Modal -->
    <div class="modal-overlay hidden" id="modal-overlay">
      <div class="modal">
        <div class="modal-title" id="modal-title">Add Funds</div>
        <div class="modal-caption" id="modal-caption">
          Simulate adding funds from an external wallet or bank account.
        </div>
        <div class="modal-input-group">
          <span>$</span>
          <input type="number" id="amount-input" placeholder="0.00" min="0" step="0.01" inputmode="decimal">
        </div>
        <div class="modal-actions">
          <button class="btn-ghost" id="modal-cancel">Cancel</button>
          <button class="btn-solid" id="modal-confirm">Confirm</button>
        </div>
      </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">Coming soon to NovaCrypto.</div>
  </div>

  <script>
    (function () {
      const BALANCE_KEY = "novaCryptoBalance";
      const LAST_UPDATE_KEY = "novaCryptoLastUpdate";
      const START_BALANCE = 40000;
      const INCREMENT_AMOUNT = 15;
      const INTERVAL_MS = 120000; // 2 minutes
      const LOADING_DURATION = 15000; // 15s

      let balance = START_BALANCE;
      let baselineBalance = START_BALANCE; // used to show "today's" gain
      let autoInterval = null;
      let currentMode = "add";

      const loadingScreen = document.getElementById("loading-screen");
      const loadingBar = document.getElementById("loading-bar");
      const app = document.getElementById("app");

      const balanceEl = document.getElementById("balance-amount");
      const balanceChangeEl = document.getElementById("balance-change");
      const changePillEl = document.getElementById("change-pill");
      const stat24hEl = document.getElementById("stat-24h-yield");

      const addBtn = document.getElementById("add-funds-btn");
      const withdrawBtn = document.getElementById("withdraw-funds-btn");

      const modalOverlay = document.getElementById("modal-overlay");
      const modalTitle = document.getElementById("modal-title");
      const modalCaption = document.getElementById("modal-caption");
      const amountInput = document.getElementById("amount-input");
      const modalCancel = document.getElementById("modal-cancel");
      const modalConfirm = document.getElementById("modal-confirm");

      const activityList = document.getElementById("activity-list");
      const toastEl = document.getElementById("toast");

      function formatCurrency(value) {
        const safeVal = isNaN(value) ? 0 : value;
        return "$" + safeVal.toLocaleString("en-US", {
          minimumFractionDigits: 2,
          maximumFractionDigits: 2
        });
      }

      function loadBalance() {
        const stored = localStorage.getItem(BALANCE_KEY);
        const storedUpdate = localStorage.getItem(LAST_UPDATE_KEY);

        if (stored !== null) {
          const parsed = parseFloat(stored);
          balance = isNaN(parsed) ? START_BALANCE : parsed;
        } else {
          balance = START_BALANCE;
        }

        // catch up auto-increments while app was closed
        if (storedUpdate) {
          const last = parseInt(storedUpdate, 10);
          if (!isNaN(last)) {
            const now = Date.now();
            const diff = now - last;
            if (diff > INTERVAL_MS) {
              const increments = Math.floor(diff / INTERVAL_MS);
              if (increments > 0) {
                balance += increments * INCREMENT_AMOUNT;
              }
            }
          }
        }

        baselineBalance = balance; // treat current balance as "start of day"
        saveBalance();
        updateBalanceUI();
      }

      function saveBalance() {
        localStorage.setItem(BALANCE_KEY, String(balance));
        localStorage.setItem(LAST_UPDATE_KEY, String(Date.now()));
      }

      function updateBalanceUI() {
        balanceEl.textContent = formatCurrency(balance);

        const delta = balance - baselineBalance;
        const isPositive = delta >= 0;
        const percentage = baselineBalance > 0
          ? (delta / baselineBalance) * 100
          : 0;

        balanceChangeEl.classList.toggle("neg", !isPositive);
        const arrow = isPositive ? "‚ñ≤" : "‚ñº";
        balanceChangeEl.innerHTML = `<span>${arrow}</span><span>${(isPositive ? "+" : "-") + formatCurrency(Math.abs(delta)).replace("$","$") } today</span>`;

        const pctText = (isPositive ? "+" : "-") + Math.abs(percentage).toFixed(2) + "%";
        changePillEl.textContent = pctText;

        // 24h yield (for prank effect, mirror "today" gain)
        stat24hEl.textContent = (delta >= 0 ? "+" : "-") + formatCurrency(Math.abs(delta)).replace("$", "$");
      }

      function prependActivity(title, subtitle, amount, type) {
        const li = document.createElement("li");
        li.className = "activity-item";

        const main = document.createElement("div");
        main.className = "activity-main";

        const t = document.createElement("div");
        t.className = "activity-title";
        t.textContent = title;

        const s = document.createElement("div");
        s.className = "activity-subtitle";
        s.textContent = subtitle;

        main.appendChild(t);
        main.appendChild(s);

        const amt = document.createElement("div");
        amt.className = "activity-amount";
        if (type === "pos") amt.classList.add("pos");
        if (type === "neg") amt.classList.add("neg");

        if (typeof amount === "number") {
          const prefix = type === "neg" ? "-" : "+";
          amt.textContent = prefix + formatCurrency(Math.abs(amount));
        } else {
          amt.textContent = amount;
        }

        li.appendChild(main);
        li.appendChild(amt);

        activityList.insertBefore(li, activityList.firstChild);

        // keep list short
        const items = activityList.querySelectorAll(".activity-item");
        if (items.length > 6) {
          activityList.removeChild(activityList.lastChild);
        }
      }

      function startAutoIncrement() {
        if (autoInterval) clearInterval(autoInterval);
        autoInterval = setInterval(() => {
          balance += INCREMENT_AMOUNT;
          saveBalance();
          updateBalanceUI();
          prependActivity(
            "Auto-yield cycle",
            "NovaCore scheduled reward",
            INCREMENT_AMOUNT,
            "pos"
          );
        }, INTERVAL_MS);
      }

      function openModal(mode) {
        currentMode = mode;
        if (mode === "add") {
          modalTitle.textContent = "Add Funds";
          modalCaption.textContent = "Simulate adding funds from an external wallet or bank.";
        } else {
          modalTitle.textContent = "Withdraw Funds";
          modalCaption.textContent = "Simulate withdrawing to your connected bank account.";
        }
        amountInput.value = "";
        modalOverlay.classList.remove("hidden");
        setTimeout(() => amountInput.focus(), 50);
      }

      function closeModal() {
        modalOverlay.classList.add("hidden");
      }

      function handleConfirm() {
        const raw = amountInput.value.trim();
        const val = parseFloat(raw);
        if (isNaN(val) || val <= 0) {
          showToast("Enter an amount greater than 0.");
          return;
        }

        if (currentMode === "add") {
          balance += val;
          prependActivity("Manual deposit", "External wallet ‚Üí NovaCrypto", val, "pos");
        } else {
          if (val > balance) {
            showToast("Insufficient balance for that withdrawal.");
            return;
          }
          balance -= val;
          prependActivity("Manual withdrawal", "NovaCrypto ‚Üí Bank account", val, "neg");
        }

        saveBalance();
        updateBalanceUI();
        closeModal();
      }

      let toastTimeout = null;
      function showToast(message) {
        toastEl.textContent = message;
        toastEl.classList.add("show");
        if (toastTimeout) clearTimeout(toastTimeout);
        toastTimeout = setTimeout(() => {
          toastEl.classList.remove("show");
        }, 1800);
      }

      function initNav() {
        const navButtons = document.querySelectorAll(".nav-item");
        navButtons.forEach(btn => {
          btn.addEventListener("click", () => {
            navButtons.forEach(b => b.classList.remove("active"));
            btn.classList.add("active");

            const tab = btn.getAttribute("data-tab");
            if (tab !== "home") {
              // Cosmetic only
              showToast("Module temporarily in read-only mode.");
            }
          });
        });
      }

      function initListeners() {
        addBtn.addEventListener("click", () => openModal("add"));
        withdrawBtn.addEventListener("click", () => openModal("withdraw"));
        modalCancel.addEventListener("click", closeModal);
        modalOverlay.addEventListener("click", (e) => {
          if (e.target === modalOverlay) closeModal();
        });
        modalConfirm.addEventListener("click", handleConfirm);
      }

      // Loading logic
      function beginLoadingSequence() {
        const steps = 100;
        const stepTime = LOADING_DURATION / steps;
        let progress = 0;

        const interval = setInterval(() => {
          progress++;
          if (progress > 100) progress = 100;
          loadingBar.style.width = progress + "%";

          if (progress >= 100) {
            clearInterval(interval);
            loadingScreen.classList.add("hidden");
            app.classList.remove("hidden");
            // now initialize app logic
            loadBalance();
            startAutoIncrement();
            initListeners();
            initNav();
          }
        }, stepTime);
      }

      // Kick everything off
      document.addEventListener("DOMContentLoaded", () => {
        beginLoadingSequence();
      });
    })();
  </script>
</body>
</html>
